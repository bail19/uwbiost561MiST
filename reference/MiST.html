<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Implementation of set-based mixed effects score tests via MiST."><title>Implementation of set-based mixed effects score tests via MiST. — MiST • uwbiost561MiST</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Implementation of set-based mixed effects score tests via MiST. — MiST"><meta property="og:description" content="Implementation of set-based mixed effects score tests via MiST."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uwbiost561MiST</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/uwbiost561MiST.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Implementation of set-based mixed effects score tests via <em>MiST</em>.</h1>
      
      <div class="d-none name"><code>MiST.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implementation of set-based mixed effects score tests via <em>MiST</em>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MiST</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"Continuous"</span>,</span>
<span>  weight_method <span class="op">=</span> <span class="st">"User"</span>,</span>
<span>  user_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>  burden_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chisq_app <span class="op">=</span> <span class="st">"3M"</span>,</span>
<span>  combinations_return <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  combination_preference <span class="op">=</span> <span class="st">"All"</span>,</span>
<span>  acc <span class="op">=</span> <span class="fl">5e-10</span>,</span>
<span>  acc_auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  accurate_app_threshold <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  max_core <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A dataframe <code>[Y,X,G]</code> with rows represent subjects and columns are <code>Y</code> (outcome), <code>X</code> (confounders), and <code>G</code> (genotypes).</p></dd>


<dt>d</dt>
<dd><p>Number of confounders. If <code>d</code> is 0, there is no confounder, and the input data should be arranged as <code>[Y G]</code>.</p></dd>


<dt>p</dt>
<dd><p>Number of genetic variants in the set.</p></dd>


<dt>R</dt>
<dd><p>Number of burden scores (R&gt;=0). When <code>R</code> is 0, only the variance component test is performed and more than one variants are required in this situation.</p></dd>


<dt>outcome_type</dt>
<dd><p>Either "Continuous" for quantitative trait, or "Binary" for dichotomous trait.</p></dd>


<dt>weight_method</dt>
<dd><p>Specifying weights for calculating weighted burden scores. It takes "User" or "No weight". "User"(default) allows user-defined weights for each variant (e.g., functional annotations and equal weights), which are specified by the input option "user_weight". "No weight" sets all weights = 0 and tests only the variance component.</p></dd>


<dt>user_weight</dt>
<dd><p>A vector or a matrix specifying weights for calculating weighted burden scores. This option only works when the weight_method is set as "User". If the weight_method is set as "User"" and no user_weight is specified, the weight is set as 1.</p></dd>


<dt>burden_scale</dt>
<dd><p>A logical value (default: TRUE) specifying if standardization on burden components needs to be carried out when there are more than 1 burden score.</p></dd>


<dt>chisq_app</dt>
<dd><p>Either "3M" (default) or "4M" for the moment matching (Liu's) method in the quantile approximation in the optimal linear combination of burden and variance components. "3M" matches the 3rd moment and "4M" matches the 4th moment of the target and approximate distributions.</p></dd>


<dt>combinations_return</dt>
<dd><p>A logical value with TRUE (default) indicating that the tests for combining the burden and variance components are performed. The combined methods include the optimal linear combination, data-adpative weighted combination, and Fisher's combination. If it is FALSE, only the burden and variance component tests are returned.</p></dd>


<dt>combination_preference</dt>
<dd><p>Either of "All" (default), or a vector containing "OptMin", "AdptWt", or "Fisher" to specify the combination method(s).</p></dd>


<dt>acc</dt>
<dd><p>A numerical value indicating the precision of the Davies method for p-value calculation. Default is 5e-10.</p></dd>


<dt>acc_auto</dt>
<dd><p>A logical value (default: TRUE) indicating if data adaptive precision is used in optimal linear combination. We recommend to set this as TRUE for computational efficiency.</p></dd>


<dt>accurate_app_threshold</dt>
<dd><p>A numerical value specifying the threshold to determine when the Liu or Davies method is used in the quantile approximation in the optimal linear combination of burden and variance components. Default is -log10(0.05).</p></dd>


<dt>max_core</dt>
<dd><p>An integer specifying the maximum number of cores that can be recruited in the parallel package. Default is 4 cores.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing <code>pvalue</code>, <code>stat</code>, <code>pvalue.ind.f</code>, <code>stat.ind.f</code>, <code>rho</code>, and <code>data.info</code>.
Specifically, <code>pvalue</code> are obtained from the burden and variance components tests, as well as three combination tests including optimal linear combination <em>oMiST</em>, data-adaptive weighted combination <em>aMiST</em>, and Fiser's combination <em>fMiST</em>.
<code>stat</code> are the corresponding test statistics.
<code>pvalue.ind.f</code> and <code>stat.ind.f</code> are p-values and test statistics of individual burden scores if multiple weights are included.
<code>rho</code> is the optimal weight of the burden and random-effects components in <em>oMiST</em> and <em>aMiST</em>.
<code>data.info</code> includes the numbers of genetic variants and burden scores.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Data generation</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">2000</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>,size<span class="op">=</span><span class="fl">1</span>,prob<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MAF</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span>,min<span class="op">=</span><span class="fl">0.001</span>,max<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">G</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">MAF</span>,<span class="kw">function</span><span class="op">(</span><span class="va">maf</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>,size<span class="op">=</span><span class="fl">1</span>,prob<span class="op">=</span><span class="va">maf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eta</span> <span class="op">=</span> <span class="va">X</span><span class="op">*</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">G</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>,size<span class="op">=</span><span class="fl">1</span>,prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>,G<span class="op">=</span><span class="va">G</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mist</span> <span class="op">=</span> <span class="fu">MiST</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>         outcome_type <span class="op">=</span> <span class="st">"Binary"</span>,</span></span>
<span class="r-in"><span>         d <span class="op">=</span> <span class="va">d</span>,</span></span>
<span class="r-in"><span>         p <span class="op">=</span> <span class="va">p</span>,</span></span>
<span class="r-in"><span>         R <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>         weight_method <span class="op">=</span> <span class="st">"User"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mist</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       stat.f       stat.r   stat.oMiST   stat.aMiST   stat.fMiST </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.711393e-04 1.791766e+01 1.791766e+01 1.682194e+00 1.723444e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pvalue.f     pvalue.r pvalue.oMiST pvalue.aMiST pvalue.fMiST </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.9793320    0.4313491    0.6788313    0.7180381    0.7864547 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stat.f.ind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pvalue.f.ind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho.oMiST.f rho.oMiST.r rho.aMiST.f rho.aMiST.r </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.00000000  1.00000000  0.02483013  0.99969168 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  p  R </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yu-Ru Su.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

